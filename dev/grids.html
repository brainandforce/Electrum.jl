<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data grids · Electrum.jl</title><meta name="title" content="Data grids · Electrum.jl"/><meta property="og:title" content="Data grids · Electrum.jl"/><meta property="twitter:title" content="Data grids · Electrum.jl"/><meta name="description" content="Documentation for Electrum.jl."/><meta property="og:description" content="Documentation for Electrum.jl."/><meta property="twitter:description" content="Documentation for Electrum.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Electrum.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="lattices.html">Lattices</a></li><li><a class="tocitem" href="atoms.html">Atoms and crystals</a></li><li class="is-active"><a class="tocitem" href="grids.html">Data grids</a><ul class="internal"><li><a class="tocitem" href="#DataGrid,-RealDataGrid,-and-ReciprocalDataGrid"><span><code>DataGrid</code>, <code>RealDataGrid</code>, and <code>ReciprocalDataGrid</code></span></a></li><li><a class="tocitem" href="#Broadcasting-and-mathematical-operations"><span>Broadcasting and mathematical operations</span></a></li></ul></li><li><a class="tocitem" href="filetypes.html">File formats</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="api/lattices.html">Lattices</a></li><li><a class="tocitem" href="api/atoms.html">Atoms</a></li><li><a class="tocitem" href="api/crystals.html">Crystals</a></li><li><a class="tocitem" href="api/data.html">Crystal data</a></li><li><a class="tocitem" href="api/filetypes.html">File formats</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="grids.html">Data grids</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="grids.html">Data grids</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/brainandforce/Electrum.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/brainandforce/Electrum.jl/blob/main/docs/src/grids.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-grids"><a class="docs-heading-anchor" href="#Data-grids">Data grids</a><a id="Data-grids-1"></a><a class="docs-heading-anchor-permalink" href="#Data-grids" title="Permalink"></a></h1><p>The output of many quantum chemistry packages are datasets defined on a spatial grid in real or reciprocal space. Theoretical tools may want to perform mathematical operations on this data, but operating on bare arrays containing the dta requires tracking properties associated with each array, such as the basis vectors of the lattice</p><h2 id="DataGrid,-RealDataGrid,-and-ReciprocalDataGrid"><a class="docs-heading-anchor" href="#DataGrid,-RealDataGrid,-and-ReciprocalDataGrid"><code>DataGrid</code>, <code>RealDataGrid</code>, and <code>ReciprocalDataGrid</code></a><a id="DataGrid,-RealDataGrid,-and-ReciprocalDataGrid-1"></a><a class="docs-heading-anchor-permalink" href="#DataGrid,-RealDataGrid,-and-ReciprocalDataGrid" title="Permalink"></a></h2><p>An <code>DataGrid{D,B&lt;:Electrum.LatticeBasis,S&lt;:AbstractVector{&lt;:Real},T}</code> contains data defined in a crystal lattice of <code>D</code> with basis vectors of type <code>B</code>, a shift parameter of type <code>S</code>, and elements of type <code>T</code>, either in real space (<code>RealDataGrid</code>) or in reciprocal space (<code>ReciprocalDataGrid</code>). These aliases are defined as follows:</p><pre><code class="language-julia hljs">const RealDataGrid{D,T} = DataGrid{D,RealBasis{D,Float64},SVector{D,Float64},T}
const ReciprocalDataGrid{D,T} = DataGrid{D,ReciprocalBasis{D,Float64},KPoint{D},T}</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Look closely at the above definition: the shift data type for <code>RealDataGrid{D}</code> is <code>SVector{D,Float64}</code>, but the shift data type for <code>ReciprocalDataGrid{D}</code> is <code>KPoint{D}</code>. When the <code>DataGrid</code> constructor without the shift type parameter is invoked, the basis type is used to infer the appropriate shift type so that a <code>RealDataGrid</code> or <code>ReciprocalDataGrid</code> is constructed.</p></div></div><p><code>DataGrid</code> uses zero-based, periodic indexing: the first index of an <code>AbstractDataGrid{D}</code> is <code>zero(NTuple{D,Int})</code>, and indices whose moduli with respect to size along that dimension are identical will reference the same element: for instance, for <code>g::AbstractDataGrid{3}</code> with size <code>(10, 10, 10)</code>, <code>g[69, 420, 1337] === g[9, 0, 7]</code>. Encountering a <code>BoundsError</code> is not possible when indexing an <code>DataGrid</code>.</p><p>The basis of an <code>DataGrid</code> can be recovered with <code>basis(::DataGrid)</code>, which will be of the type specified by the type parameter. </p><h2 id="Broadcasting-and-mathematical-operations"><a class="docs-heading-anchor" href="#Broadcasting-and-mathematical-operations">Broadcasting and mathematical operations</a><a id="Broadcasting-and-mathematical-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Broadcasting-and-mathematical-operations" title="Permalink"></a></h2><p>Broadcasting is defined for <code>DataGrid</code> with a custom <code>Base.Broadcast.BroadcastStyle</code> subtype:</p><pre><code class="language-julia hljs">Electrum.DataGridStyle{D,B,S} &lt;: Broadcast.AbstractArrayStyle{D}</code></pre><p>This allows <code>DataGrid</code> instances to operated on with dot syntax. However, they must share lattice basis vectors and shift values. If they do not match, an <code>Electrum.LatticeMismatch</code> exception will be thrown.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Although <code>Base.Broadcast.ArrayStyle</code> is usually overridden by other subtypes of  <code>Base.Broadcast.AbstractArrayStyle</code>, it does not override <code>Electrum.DataGridStyle</code>. Adding a <code>DataGrid</code> to an <code>Array</code> returns an <code>Array</code>, and adding a <code>DataGrid</code> to other <code>AbstractArray</code> subtypes returns the <code>AbstractArray</code> subtype defined by the <code>Broadcast.BroadcastStyle</code>. In the  case of a dimension mismatch, the broadcast style wll be <code>Broadcast.ArrayConflict</code> - the operation will throw a <code>DimensionMismatch</code>.</p></div></div><p>The <code>+</code> and <code>-</code> operators are defined for <code>DataGrid</code> instances, and they are faster than the broadcasted <code>.+</code> and <code>.-</code> equivalents. As with the broadcasted versions, checks are implemented to ensure that the lattice basis vectors and shifts match.</p><p>Similarly, the <code>*</code>, <code>/</code>, and <code>\</code> operators are defined for pairs of <code>DataGrid</code> and <code>Number</code> instances, and again, are faster than their broadcasted equivalents.</p><h3 id="Fourier-transforms"><a class="docs-heading-anchor" href="#Fourier-transforms">Fourier transforms</a><a id="Fourier-transforms-1"></a><a class="docs-heading-anchor-permalink" href="#Fourier-transforms" title="Permalink"></a></h3><p>The Fourier transform and its inverse are available through an overload of <code>FFTW.fft()</code> and <code>FFTW.ifft()</code>. The transforms are normalized with respect to the basis vectors of the space, so for <code>g::DataGrid</code>, <code>ifft(fft(g)) ≈ g</code> (to within floating point error).</p><p><code>fft</code> and <code>ifft</code> defined for <code>DataGrid</code> generally, but it is critical to note that in the vast majority of cases, you will want to call <code>fft</code> on <code>RealDataGrid</code> instances and <code>ifft</code> on <code>ReciprocalDataGrid</code> instances.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="atoms.html">« Atoms and crystals</a><a class="docs-footer-nextpage" href="filetypes.html">File formats »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.0 on <span class="colophon-date" title="Thursday 30 November 2023 02:12">Thursday 30 November 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
