<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Atoms and crystals · Electrum.jl</title><meta name="title" content="Atoms and crystals · Electrum.jl"/><meta property="og:title" content="Atoms and crystals · Electrum.jl"/><meta property="twitter:title" content="Atoms and crystals · Electrum.jl"/><meta name="description" content="Documentation for Electrum.jl."/><meta property="og:description" content="Documentation for Electrum.jl."/><meta property="twitter:description" content="Documentation for Electrum.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Electrum.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="lattices.html">Lattices</a></li><li class="is-active"><a class="tocitem" href="atoms.html">Atoms and crystals</a><ul class="internal"><li><a class="tocitem" href="#NamedAtom"><span><code>NamedAtom</code></span></a></li><li><a class="tocitem" href="#Atomic-positions"><span>Atomic positions</span></a></li><li><a class="tocitem" href="#Crystals"><span>Crystals</span></a></li></ul></li><li><a class="tocitem" href="grids.html">Data grids</a></li><li><a class="tocitem" href="filetypes.html">File formats</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="api/traits.html">Traits</a></li><li><a class="tocitem" href="api/geometry.html">Geometry</a></li><li><a class="tocitem" href="api/atoms.html">Atoms</a></li><li><a class="tocitem" href="api/crystals.html">Crystals</a></li><li><a class="tocitem" href="api/data.html">Crystal data</a></li><li><a class="tocitem" href="api/filetypes.html">File formats</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="atoms.html">Atoms and crystals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="atoms.html">Atoms and crystals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/brainandforce/Electrum.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/brainandforce/Electrum.jl/blob/main/docs/src/atoms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Atoms"><a class="docs-heading-anchor" href="#Atoms">Atoms</a><a id="Atoms-1"></a><a class="docs-heading-anchor-permalink" href="#Atoms" title="Permalink"></a></h1><p>Once a lattice is defined, we can include other data, and atomic coordinates are one of the most common datasets encountered.</p><h2 id="NamedAtom"><a class="docs-heading-anchor" href="#NamedAtom"><code>NamedAtom</code></a><a id="NamedAtom-1"></a><a class="docs-heading-anchor-permalink" href="#NamedAtom" title="Permalink"></a></h2><p>A <code>NamedAtom</code> contains two pieces of information: an atom name and the associated atomic number. The atom name is a string no longer than 15 codepoints (internally, we use  <code>InlineStrings.InlineString15</code> to store this data), and the atomic number is an <code>Int</code>.</p><h3 id="Constructors"><a class="docs-heading-anchor" href="#Constructors">Constructors</a><a id="Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Constructors" title="Permalink"></a></h3><p>The default constructor for <code>NamedAtom</code> is <code>NamedAtom(::AbstractString, ::Integer)</code>. The atom name can be inferred and specified automatically as the associated symbol if only a number is given.</p><p>In the case of only a string being provided, the atomic number may be inferred. This is done by matching the first letters up to a non-letter character of the string with a known symbol. If no match is found, the atomic number will be 0, corresponding to a dummy atom (see below).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Support for inferring from symbols representing unnamed elements or atomic numbers of those elements (for instance, element 119, Uue) is not yet implemented.</p></div></div><h3 id="Sorting"><a class="docs-heading-anchor" href="#Sorting">Sorting</a><a id="Sorting-1"></a><a class="docs-heading-anchor-permalink" href="#Sorting" title="Permalink"></a></h3><p><code>NamedAtom</code> types are sorted by atomic number first, then by name.</p><h3 id="Dummy-atoms"><a class="docs-heading-anchor" href="#Dummy-atoms">Dummy atoms</a><a id="Dummy-atoms-1"></a><a class="docs-heading-anchor-permalink" href="#Dummy-atoms" title="Permalink"></a></h3><p>Sometimes, it is useful to include <em>dummy atoms</em>: sites which do not correspond to a real atomic position, but are useful to track in certain circumstances. Dummy atoms have atomic number zero.</p><p>If no string is provided, <code>NamedAtom(0)</code> returns <code>NamedAtom(&quot;dummy&quot;, 0)</code>, as does any argument not between 1 and 118.</p><h2 id="Atomic-positions"><a class="docs-heading-anchor" href="#Atomic-positions">Atomic positions</a><a id="Atomic-positions-1"></a><a class="docs-heading-anchor-permalink" href="#Atomic-positions" title="Permalink"></a></h2><h3 id="Atom-position-data"><a class="docs-heading-anchor" href="#Atom-position-data">Atom position data</a><a id="Atom-position-data-1"></a><a class="docs-heading-anchor-permalink" href="#Atom-position-data" title="Permalink"></a></h3><p>Atomic positions are given by a <code>CartesianAtomPosition{D}</code> for Cartesian coordinates, or a <code>FractionalAtomPosition{D}</code> for fractional coordinates with respect to a lattice. This information consists of a <code>NamedAtom</code>, a coordinate in real space as an <code>SVector{D,Float64}</code>, and optional occupancy data for partially occupied sites - if not specified, it defaults to 1 (fully occupied).</p><h3 id="Lists-of-atomic-positions"><a class="docs-heading-anchor" href="#Lists-of-atomic-positions">Lists of atomic positions</a><a id="Lists-of-atomic-positions-1"></a><a class="docs-heading-anchor-permalink" href="#Lists-of-atomic-positions" title="Permalink"></a></h3><p>The <code>AbstractAtomList{D}</code> type represents a list of atoms.</p><p><code>AtomList{D}</code> is a wrapper for <code>Vector{CartesianAtomPosition{D}}</code>, and represents atomic positions in an arbitrary <code>D</code>-dimensional space.</p><p><code>PeriodicAtomList{D}</code> wraps <code>Vector{FractionalAtomPosition{D}}</code>, but also includes the basis vectors of the lattice associated with fractional coordinates.</p><p>The two types can be interconverted with the appropriate constructors. An <code>AtomList</code> can be constructed from a <code>PeriodicAtomList</code> directly, but for the reverse conversion, the basis vectors of the new <code>PeriodicAtomList</code> must be specified.</p><h3 id="Sorting-2"><a class="docs-heading-anchor" href="#Sorting-2">Sorting</a><a class="docs-heading-anchor-permalink" href="#Sorting-2" title="Permalink"></a></h3><p>Structures often have many identical <code>NamedAtom</code> instances, so sorting of <code>FractionalAtomPosition</code> and <code>CartesianAtomPosition</code> is accomplished by whichever has the lowest initial coordinate, moving to the next coordinate in the case of ties.</p><h3 id="Constructing-supercells"><a class="docs-heading-anchor" href="#Constructing-supercells">Constructing supercells</a><a id="Constructing-supercells-1"></a><a class="docs-heading-anchor-permalink" href="#Constructing-supercells" title="Permalink"></a></h3><p>In many cases, it is useful to construct a supercell from a unit cell. This can be done to convert a primitive cell to a conventional representation, or to a cell of a larger size or different shape.</p><p>The <code>supercell(::PeriodicAtomList, ::AbstractMatrix{&lt;:Integer})</code> function takes an <code>AbstractMatrix{&lt;:Integer}</code>, which transforms the lattice basis vectors by right multiplication, and fills the new lattice with copies of atoms from the original cell. Scalar arguments (calling <code>supercell(::PeriodicAtomList, ::Integer)</code>) scale each direction by the identity matrix multiplied by the scalar, and vector arguments (calling <code>supercell(::PeriodicAtomList, ::Integer)</code>) convert the vector to a diagonal matrix.</p><p>Internally, this is done using the [Smith normal form][1] of the transformation matrix, using the diagonal factors to extend the lattice the correct number of times along specific dimensions, and moving them into the cell with the help of the unimodular factors associated with the Smith normal form.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Electrum.supercell-atoms" href="#Electrum.supercell-atoms"><code>Electrum.supercell</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">supercell(l::PeriodicAtomList, M) -&gt; PeriodicAtomList</code></pre><p>Creates a new <code>AtomList</code> with the basis vectors of a supercell generated by transforming the basis  vectors of the space by <code>M</code>, which may be an integer matrix, an integer vector which is treated as a diagonal matrix, or a plain integer, which performs a uniform scaling. This function will also generate new atomic positions to fill the cell.</p><p>The function performs this transformation by calculating the Smith normal form of the transformation matrix. This matrix provides the integer scaling factors needed to stretch the supercell, and the left unimodular factor is then used to perform the final transformation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/brainandforce/Electrum.jl/blob/3146adb2b45fbc06bd536fa5b67f35adb52cd4c4/src/atoms.jl#L437-L448">source</a></section></article><h2 id="Crystals"><a class="docs-heading-anchor" href="#Crystals">Crystals</a><a id="Crystals-1"></a><a class="docs-heading-anchor-permalink" href="#Crystals" title="Permalink"></a></h2><p>The <code>Crystal{D}</code> represents a generating set of atomic positions for a periodic structure. Along with a <code>PeriodicAtomList</code>, a <code>Crystal{D}</code> contains the space group and origin setting associated with the data, as well as an integer matrix transformation describing the unit cell generated by the given cell. The <code>set_transform!</code> function allows for the transformation matrix to be altered  after the creation of a <code>Crystal{D}</code> object.</p><p>This data can be converted to a <code>PeriodicAtomList{D}</code> with a constructor or <code>Base.convert</code> call, and this uses the <code>supercell</code> function to construct the full list of atoms from the generating set.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>At the moment, the use of space group data to generate atomic sites is not yet implemented. A space group number and setting may be provided, but this will not be used to generate any atomic sites. </p></div></div><p>Additionally, we provide the <code>CrystalWithDatasets{D,K,V}</code>, which associates a <code>Crystal{D}</code> with a <code>Dict{K,V}</code> containing datasets associated with the structure. This data structure may be indexed like the underlying dictionary.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>CrystalWithDatasets{D,K,V}</code> will likely be changed significantly or removed in Electrum 0.2.</p></div></div><p>[1]: https://en.wikipedia.org/wiki/Smith<em>normal</em>form</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="lattices.html">« Lattices</a><a class="docs-footer-nextpage" href="grids.html">Data grids »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 8 December 2023 03:51">Friday 8 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
